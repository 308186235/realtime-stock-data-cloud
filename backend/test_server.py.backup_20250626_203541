#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
åç«¯æœåŠ¡æµ‹è¯•è„šæœ¬
"""

import requests
import json
import time

def test_backend_service():
    """æµ‹è¯•åç«¯æœåŠ¡"""
    base_url = "http://localhost:8000"
    
    print("ğŸ§ª æµ‹è¯•åç«¯æœåŠ¡è¿æ¥...")
    print("=" * 50)
    
    # æµ‹è¯•æ ¹è·¯å¾„
    try:
        response = requests.get(f"{base_url}/", timeout=5)
        print(f"âœ… æ ¹è·¯å¾„æµ‹è¯•: {response.status_code}")
        print(f"   å“åº”: {response.json()}")
    except Exception as e:
        print(f"âŒ æ ¹è·¯å¾„æµ‹è¯•å¤±è´¥: {e}")
    
    print()
    
    # æµ‹è¯•å¥åº·æ£€æŸ¥
    try:
        response = requests.get(f"{base_url}/api/health", timeout=5)
        print(f"âœ… å¥åº·æ£€æŸ¥: {response.status_code}")
        print(f"   å“åº”: {response.json()}")
    except Exception as e:
        print(f"âŒ å¥åº·æ£€æŸ¥å¤±è´¥: {e}")
    
    print()
    
    # æµ‹è¯•ç³»ç»ŸçŠ¶æ€
    try:
        response = requests.get(f"{base_url}/api/v1/agent-trading/system-status", timeout=5)
        print(f"âœ… ç³»ç»ŸçŠ¶æ€: {response.status_code}")
        print(f"   å“åº”: {response.json()}")
    except Exception as e:
        print(f"âŒ ç³»ç»ŸçŠ¶æ€æµ‹è¯•å¤±è´¥: {e}")
    
    print()
    
    # æµ‹è¯•T+0è‚¡ç¥¨æ± 
    try:
        response = requests.get(f"{base_url}/api/v1/agent-trading/t0-stocks", timeout=5)
        print(f"âœ… T+0è‚¡ç¥¨æ± : {response.status_code}")
        data = response.json()
        print(f"   è‚¡ç¥¨æ•°é‡: {data['data']['total']}")
        for stock in data['data']['stocks']:
            print(f"   - {stock['symbol']} {stock['name']}: Â¥{stock['price']}")
    except Exception as e:
        print(f"âŒ T+0è‚¡ç¥¨æ± æµ‹è¯•å¤±è´¥: {e}")
    
    print()
    print("ğŸ‰ åç«¯æœåŠ¡æµ‹è¯•å®Œæˆï¼")

if __name__ == "__main__":
    test_backend_service()
