# 🚀 实时股票数据测试工具包

## 📋 概述

这是一套完整的实时股票数据推送测试工具，用于验证 **QT_wat5QfcJ6N9pDZM5** API的数据推送功能。

### 🎯 主要功能
- ✅ **连接测试**: 验证WebSocket连接和API响应
- 📊 **实时监控**: 持续监控数据推送状态
- 🌐 **Web界面**: 浏览器可视化监控面板
- ⏰ **交易时间检测**: 自动识别市场开盘时间
- 📈 **数据统计**: 实时统计接收数据量和质量

---

## 🛠️ 工具列表

### 1. 📁 **核心测试文件**
```
realtime_data_connection_tester.py  # 连接测试器
realtime_monitor.py                 # 实时监控器  
frontend/realtime_data_monitor.html # Web监控页面
start_realtime_test.py              # Python启动器
start_realtime_test.bat             # Windows批处理启动器
```

### 2. 🔧 **配置信息**
```
API Key: QT_wat5QfcJ6N9pDZM5
推送间隔: 3秒
支持股票: 5000+ A股
数据格式: 沪深A股33字段 + 北交所JSON
交易时间: 9:00-15:00 (工作日)
```

---

## 🚀 快速开始

### 方法1: Windows一键启动 (推荐)
```bash
# 双击运行
start_realtime_test.bat
```

### 方法2: Python启动器
```bash
python start_realtime_test.py
```

### 方法3: 手动启动
```bash
# 1. 启动后端服务
set PORT=8001
python backend/app.py

# 2. 运行测试 (选择其一)
python realtime_data_connection_tester.py  # 连接测试
python realtime_monitor.py                 # 实时监控

# 3. 打开Web页面
# 浏览器打开: frontend/realtime_data_monitor.html
```

---

## 📊 测试工具详解

### 🔍 **连接测试器** (`realtime_data_connection_tester.py`)

**功能**: 快速验证系统连接和基本功能
```
✅ 后端API连接测试
✅ WebSocket连接测试  
✅ 实时数据接收测试
✅ 数据质量分析
✅ 自动生成测试报告
```

**使用场景**: 
- 首次部署后验证
- 故障排查
- 定期健康检查

### 📊 **实时监控器** (`realtime_monitor.py`)

**功能**: 持续监控数据推送状态
```
📈 实时数据统计
🔄 自动重连机制
📋 详细日志记录
⏰ 运行时间统计
📊 股票数据分组统计
```

**使用场景**:
- 长期监控数据推送
- 性能测试
- 数据质量监控

### 🌐 **Web监控页面** (`frontend/realtime_data_monitor.html`)

**功能**: 浏览器可视化监控面板
```
🎨 美观的可视化界面
📊 实时数据图表
🔔 状态指示器
📈 股票价格实时更新
📋 操作日志显示
```

**使用场景**:
- 直观的数据展示
- 演示和展示
- 移动端监控

---

## ⏰ 交易时间说明

### 📅 **最佳测试时间**
```
🟢 交易时间: 周一至周五 9:00-15:00
   - 9:00-9:30: 预热时间，开始推送数据
   - 9:30-11:30: 上午交易时间
   - 13:00-15:00: 下午交易时间

🔴 非交易时间: 
   - 周末、节假日
   - 工作日 15:00-次日9:00
   - 可能只有模拟数据
```

### 💡 **测试建议**
- ✅ **9:00后测试**: 确保能接收到真实数据推送
- ✅ **工作日测试**: 避免周末和节假日
- ✅ **持续监控**: 运行30分钟以上观察稳定性
- ✅ **多股票订阅**: 测试不同股票的数据推送

---

## 🔧 故障排查

### ❌ **常见问题**

#### 1. **WebSocket连接失败**
```
原因: 后端服务未启动或端口被占用
解决: 
- 检查后端服务是否运行在8001端口
- 确认防火墙设置
- 尝试重启后端服务
```

#### 2. **无法接收数据**
```
原因: 数据源配置不完整
解决:
- 检查环境变量: MARKET_DATA_HOST, MARKET_DATA_PORT, MARKET_DATA_TOKEN
- 确认在交易时间内测试
- 检查网络连接
```

#### 3. **数据推送间断**
```
原因: 网络不稳定或数据源问题
解决:
- 检查网络连接稳定性
- 观察错误日志
- 尝试重新连接
```

### 🔍 **调试步骤**

1. **检查后端状态**
   ```bash
   curl http://localhost:8001/api/health
   ```

2. **查看后端日志**
   ```bash
   # 查看后端控制台输出
   ```

3. **测试WebSocket连接**
   ```bash
   # 使用Web监控页面测试连接
   ```

4. **检查配置文件**
   ```bash
   # 确认 backend/config/settings.py 中的配置
   ```

---

## 📈 预期结果

### ✅ **正常运行状态**
```
🔗 连接状态: 已连接
📊 接收数据: 持续增长
📈 活跃股票: 9-10只 (监控列表)
⏰ 推送间隔: 约3秒
❌ 错误次数: 0或极少
```

### 📊 **数据示例**
```
[09:32:15] | 000001 | ¥12.45 | +0.15 (+1.22%)
[09:32:18] | 600000 | ¥10.88 | -0.05 (-0.46%)
[09:32:21] | 600519 | ¥1680.50 | +8.20 (+0.49%)
```

---

## 🎯 下一步计划

### 🔄 **如果测试成功**
1. ✅ 确认数据推送正常工作
2. 🔧 配置真实的数据源参数
3. 🚀 部署到生产环境
4. 📊 集成到交易系统

### ❌ **如果测试失败**
1. 📋 收集错误日志和测试报告
2. 🔍 根据故障排查指南检查配置
3. 🛠️ 修复配置问题
4. 🔄 重新运行测试

---

## 📞 技术支持

### 📋 **报告问题时请提供**
- 🕐 测试时间 (是否在交易时间)
- 📊 测试结果和错误信息
- 🔧 系统配置信息
- 📋 完整的错误日志

### 💡 **优化建议**
- 🚀 在交易时间进行测试以获得最佳结果
- 📊 运行多次测试确保稳定性
- 🔄 定期监控数据推送质量
- 📈 根据实际需求调整监控股票列表

---

## 🎉 总结

这套测试工具可以帮助您：
- ✅ 验证实时数据推送功能
- 📊 监控系统运行状态  
- 🔍 快速定位和解决问题
- 📈 确保数据质量和稳定性

**建议在9:00后运行测试，以验证真实的股票数据推送功能！** 🚀
